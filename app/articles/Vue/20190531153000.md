
# Vue 高级教程


## 响应式

使用了 `ES5` 的 `Object.definePropery` 重写所有属性的 `getter` 和 `setter` 方法；

```js
function convert(obj) {
    Object.keys(obj).forEach(key => {
        let internalValue = obj[key];
        Object.defineProperty(obj, key, {
            get () {
                console.log(`getting key "${key}": ${internalValue}`);
                return internalValue;
            },
            set (newValue) {
                console.log(`setting key "${key}" to: ${newValue}`);
                internalValue = newValue;
            },
        })
    });
}
```

## 

```js
let activeUpdate = null;
window.Dep = class Dep {
    constructor () {
        this.subscribers = new Set();
    }
    depend () {
        if (activeUpdate) {
            this.subscribers.add(activeUpdate);
        }
    }
    notify () {
        this.subscribers.forEach(sub => sub());
    }
}
function autorun (update) {
    function wrappedUpdate () {
        activeUpdate = wrappedUpdate;
        update();
        activeUpdate = null;
    }
    wrappedUpdate();
}
```

## 插件简介

```js
function plugin (Vue, options) {
    // ...plugin code
}
Vue.use(plugin);
```


##  Render Function

template
-> (compiled into) Render Function
-> (returns) Virtual DOM
-> (generates) Actual DOM


Actual DOM
```
'[object HTMLDivElement]'
```

Virtual DOM
```
'{ tag: 'div', data: { attrs: {}, ... }, children: [] }'
```

Render Function API
```
export defualt {
    render (h) {
        return h('div', {}, [...]);
    }
}
```

案例
```html
<template>
    <example :tags="['h1', 'h2', 'h3']"></example>
</template>
<script>
    Vue.component('example', {
        props: ['tags'],
        render (h) {
            const children = this.tags.map((tag, index) => h(tag, index));
            return h('div', children);
        }
    })
</script>
```
