
# React

> [中文官网](https://react.docschina.org/)

用于构建用户界面的 `JavaScript` 库。

特点：
- 声明式的设计；
- 高效，采用虚拟 `DOM` 来实现 `DOM` 的渲染，最大限度的减少 `DOM` 的操作；
- 灵活，跟其他库可灵活搭配使用；
- 使用 `JSX`；
- 组件化、模块化，代码容易复用。
- 单向数据流。没有实现数据的双向绑定。数据 => 视图 => 事件 => 数据；


## React 脚手架创建项目

步骤
1. 安装脚手架 `create-react-app`；
```
npm install -g create-react-app
```
2. 创建项目；
```
create-react-app <project-directory>
```
3. 启动
```
npm run start
```
4. 打包部署
```
npm run build
```

## React JSX

使用 `JSX` 的写法，可以创建 `JS` 元素对象
```
const h1 = <h1>helloworld</h1>;
```

**注意**
- `JSX` 元素对象或者组件对象，必须只有一个根元素节点；
- 正常的普通 `HTML` 元素要小写。如果是大写，默认认为是组件；

函数式组件开发
```
// react 函数式组件
function Clock(props) {
    return (
        <div>
            <h1>现在的时间是{props.date.toLocaleTimeString()}</h1>
            <h2>这是副标题</h2>
        </div>
    )
}
```

JSX Style 样式

```
let exampleStyle = {
    background: 'blue',
    borderBottom: '1px solid red',
    'background-image': '',
};
let arrClassName = ['bg', 'fontsize'];
let element = (
    <div>
        <h1 className={arrClassName.join(' ')} style={exampleStyle}>hello world</h1>
    </div>
);
ReactDOM.render(
    element,
    document.getElementById('root'),
);
```

注释写法
```
let element = (
    <div>
        {/*这里写注释*/}
        <h1 className={arrClassName.join(' ')} style={exampleStyle}>hello world</h1>
    </div>
);
```

## React 组件

分为函数式组件和类组件，区别：
- 函数式比较简单，一般用于静态没有交互事件的内容；
- 类组件一般又称为动态组件，会有交互或者数据修改的操作；

### 函数式组件

创建
```
function HelloWorld (props) {
    return (
        <div>
            <h1>hello world</h1>
        </div>
    );
}
```

使用
```
ReactDOM.render(
    <HelloWorld />,
    document.getElementById('root'),
);
```


### 类组件

创建
```
class HelloWorld extends React.Component {
    render() {
        console.log(this.props);
        return (
            <div>
                <h1>hello world</h1>
            </div>
        );
    }
}
```

使用
```
ReactDOM.render(
    <HelloWorld />,
    document.getElementById('root'),
);
```

## React 生命周期事件

- 绑定事件命名为驼峰命名法；
- 传入一个函数，而不是字符串；

**注意** `React` 返回的事件对象是代理的原生的事件对象，如果想要
查看事件对象具体属性，需要直接输出该属性；

组件从实例化到最终从页面中销毁的这整个过程就是生命周期。
在这个过程当中，有许多生命周期钩子函数。

生命周期的三个状态
- `Mounting` ： 将组件插入到 `DOM` 中；
- `Updating` ： 将数据更新到 `DOM` 中；
- `Unmounting` ： 将组件移除 `DOM` 中；

生命周期中的钩子函数（方法、事件）
- `componentWillMount` 组件将要挂载渲染
- `componentDidMount` 组件渲染完毕
- `componentWillReceiveProps` 组件将要接收 `props` 数据
- `shouldComponentUpdate` 组件接收到新的 `state` 或者 `props` ，判断是否更新，返回布尔值
- `componentWillUpdate` 组件将要更新
- `componentDidUpdate` 组件已经更新
- `componentWillUnmount` 组件将要卸载

```
class Lifecycle extends React.Component {
    constructor (props) {
        super(props);
    }
    // 组件将要挂载渲染
    componentWillMount() {

    }
    // 组件渲染完毕
    componentDidMount() {

    }
    // 组件将要接收 props 数据
    componentWillReceiveProps(nextProps, nextContext) {

    }
    // 组件接收到新的 state 或者 props ，判断是否更新，返回布尔值
    shouldComponentUpdate(nextProps, nextState, nextContext) {

    }
    // 组件将要更新
    componentWillUpdate(nextProps, nextState, nextContext) {

    }
    // 组件已经更新
    componentDidUpdate(prevProps, prevState, snapshot) {

    }
    // 组件将要卸载
    componentWillUnmount(){
        
    }
}
```

## React State 状态

```
class Clock extends React.Component {
    constructor (props) {
        super(props);
        // 构造函数初始化数据
        this.state = {
            time: new Date().toLocaleTimeString(),
        }
    }
    render() {
        return (
            <div>
                <p>当前时间：{this.state.time}</p>
            </div>
        );
    }
    // 生命周期函数，组件渲染完成的函数
    componentDidMount() {
        setInterval(() => {
            // 设置状态修改数据
            this.setState({
                time: new Date().toLocaleTimeString(),
            });
            // 注意此时 this.state.time 值不一定会是修改之后的值
            // react 会在设置完状态后，对比虚拟 DOM 对象，然后再统一修改，提升性能
            console.log(this.state.time);  
        }, 1000);
    }
}
```

## React Props 

- 父组件传给子组件的数据，单向流动，不能子组件传递给父组件；
- 可以是任意类型的值，可以是函数，所以可以通过函数去修改父组件的状态；
- 可以设置默认值；

```
class ParentComponent extends React.Component {
    constructor (props) {
        super (props);
        this.state = {
            text: '',
        }
    }
    onText (e) {
        this.setState({ text: e });
    }
    render () {
        return (
            <div>
                <p>从子组件接收到的参数：{this.state.text}</p>
                <ChildComponent onText={ (e) => this.onText(e) } />
            </div>
        )
    }
}
class ChildComponent extends React.Component {
    constructor (props) {
        super (props);
    }
    onClick () {
        this.props.onText('hello world');
    }
    render () {
        return (
            <div>
                <button onClick={ () => this.onClick() }>给父组件传递参数</button>
            </div>
        )
    }
}
```

## React 条件渲染

- `if...else...`；
- 三元运算符；

```
class TabSwitch extends React.Component {
    constructor (props) {
        super(props);
        this.state = {
            index: 0,
        }
    }
    onClick (index) {
        this.setState({ index });
    }
    render () {
        return (
            <div>
                <div>
                    <button onClick={() => this.onClick(0)}>按钮1</button>
                    <button onClick={() => this.onClick(1)}>按钮2</button>
                </div>
                {
                    this.state.index === 0 ? <div>内容1</div> : <div>内容2</div>
                }
            </div>
        );
    }
}
```

## React 列表渲染

```
class ListComponent extends React.Component {
    constructor (props) {
        super(props);
        this.state = {
            arr: [ 'a', 'b', 'c', 'd' ]
        }
    }
    render () {
        return (
            <ul>{this.state.arr.map((item, index) => <li key={index}>{item}</li>)}</ul>
        );
    }
}
```
